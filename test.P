users(1).
users(2).
users(3).
users(4).
users(5).

roles(ceo).
roles(lead).
roles(ed).
roles(vp).
roles(manager).

perms(r).
perms(w).
perms(x).
perms(rw).
perms(wx).


ur(1,ceo).
ur(2,lead).
ur(3,ed).
ur(4,vp).
ur(5,manager).

rp(ceo,ceoread).
rp(ceo,ceoexecute).
rp(lead,leadread).
rp(lead,leadexecute).
rp(ed,edread).
rp(ed,edexecute).
rp(vp,vpread).
rp(vp,vpexecute).
rp(manager,managerread).
rp(manager, managerexecute).

rh(ceo,lead).
rh(ceo,ed).
rh(ed,vp).
rh(ed,manager).

authorized_roles(X,Y) :-
	ur(X,Y).
	
authorized_roles(X,Y) :-
	ur(X,XR),
	ur(Z,ZR),
	rh(XR,ZR),
	authorized_roles(Z,Y).
	
authorized_permissions(X,Y) :- 
	authorized_roles(X,Z),
	all_roles(Z,Y).

all_roles(X,Y) :- 
	rp(X,Y).
	
	

